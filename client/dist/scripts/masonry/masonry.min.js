export const constants=(()=>{'use strict';const e={DEBOUNCE(e=(()=>{}),t=100){let n;return(...o)=>{n&&clearTimeout(n),n=setTimeout((()=>{e(...o),n=null}),t)}},THROTTLING(e=(()=>{}),t=100){let n;return(...o)=>{n||(n=setTimeout((()=>{e(...o),n=null}),t))}},REDUCE(e,t,n){n||(n=t[Symbol.iterator](),t=n.next().value);for(const o of n)t=e(t,o);return t},GO:(...t)=>()=>e.REDUCE(((e,t)=>t(e)),t),RO(t=(()=>{}),n=100){const o=e.DEBOUNCE(t,n),s=new ResizeObserver(((e,t)=>{o(e)}));return{observe(e){s.observe(e)},unobserve(e){s.unobserve(e)},disconnect(){s.disconnect()}}},IO(e=(()=>{})){const t=new IntersectionObserver(((t,n)=>{e(t)}));return{observe(e){t.observe(e)},unobserve(e){t.unobserve(e)},disconnect(){t.disconnect()}}},IS_DESKTOP(){const e=window.navigator.userAgent;return/windows nt|macintosh|linux/i.test(e)}},t={async GET(e,t,n={}){const o={method:'GET',headers:{'Content-Type':'application/json',...n}},s=await fetch(e,o),r=await s.json();if(s.ok)return r;if(!s.ok)throw Error(r)}},n={BODY:document.querySelector('body')};return{METHODS:e,FETCH:t,ELEMENT:n}})();const{METHODS:METHODS,FETCH:FETCH,ELEMENT:ELEMENT}=constants,{BODY:BODY}=ELEMENT,masonryJS=({element:e=document.querySelector('.masonry'),options:t={}}={})=>{const n=e;if(!n)return()=>{};const o={rows:3,gap:10,timing:300,breakpoints:{},...t};n.setAttribute('style',`padding: 0 ${o.gap/2}px;`);const s={widthMasonry:n.clientWidth,rowsHeight:new Array(o.rows).fill(0),width:Math.floor((n.clientWidth-o.gap)/o.rows),totalElement:new Map,newElement:new Map,breakpoints:new Set(Object.keys(o.breakpoints).sort(((e,t)=>Number(t)-Number(e))))},r=()=>{s.rowsHeight=new Array(o.rows).fill(0)},i=()=>{s.width=Math.floor((s.widthMasonry-o.gap)/o.rows)},a=e=>{if(0!==e.size)for(const[,t]of e){t.querySelector('img').style.display||t.querySelector('img').setAttribute('style','display: block; width: 100%; height: auto;'),t.setAttribute('style',`position: absolute; \n                top: 0; \n                left: ${o.gap/2}px; \n                width: ${s.width}px; \n                padding: 0 ${o.gap/2}px; \n                box-sizing: border-box;`);const e=t.offsetHeight,r=s.rowsHeight.indexOf(Math.min(...s.rowsHeight))<0?0:s.rowsHeight.indexOf(Math.min(...s.rowsHeight));t.style.transform=`translate(${s.width*r}px, ${Number(s.rowsHeight[r])+o.gap}px)`,t.classList.remove('isNew'),s.rowsHeight[r]=s.rowsHeight[r]+e+o.gap,n.dataset.arr=s.rowsHeight.join(' '),s.newElement.has(t)&&s.newElement.delete(t)}},l=()=>{if(0!==s.breakpoints.size)for(let e of s.breakpoints){if(s.widthMasonry>Number(e)){o.rows=o.breakpoints[e].rows;break}o.rows=t.rows}},c=()=>{(()=>{const e=n.querySelectorAll('.img-wrap.isNew'),t=e.length;for(let n=0;n<t;n++)s.totalElement.has(e[n])||(s.totalElement.set(e[n],e[n]),s.newElement.set(e[n],e[n]))})(),i(),a(s.newElement)};l(),r();return METHODS.RO((()=>{requestAnimationFrame((()=>{const e=n.clientWidth,t=e!==s.widthMasonry;t&&(l(),r(),i()),a(t?s.totalElement:s.newElement),s.widthMasonry=e}))}),10).observe(n),()=>{c()}},prototype=(()=>{'use strict';let e=0,t=null,n=null;const o=document.querySelector('.masonry'),s=(e=!1)=>{n.style.display=e?'flex':'none'},r=(e=!1)=>{t.classList[e?'add':'remove']('disconnect'),e&&(()=>{const e=o.dataset.arr.split(' ')??[],n=Math.max(...e);t.style.transform=`translateY(${n<0?window.innerHeight+10:n-20}px)`,window.innerHeight>n&&(t.classList.remove('disconnect'),l())})()},i=masonryJS({element:document.querySelector('.masonry'),options:{rows:2,breakpoints:{767:{rows:3},1023:{rows:5}}}}),a=async e=>{((e=[])=>{if(!i)return;if(!o)return;if(0===e.length)return;const t=e.reduce(((e,t)=>[...e,`<div class="img-wrap isNew">\n                    <img src="${t.download_url}" width="${t.width}" height="${t.height}" alt="${t.author}">\n                </div>`]),[]);o.insertAdjacentHTML('beforeend',t.join(''))})(e),i(),r(!0),s()},l=()=>{if(t.classList.contains('disconnect'))return r();(async()=>{s(!0);const t=await(async()=>(e++,await FETCH.GET(`https://picsum.photos/v2/list?page=${e}&limit=20`)))();t&&await a(t)})()};return{init:()=>{n=document.createElement('div'),Object.assign(n,{id:'loader',className:'loader-wrap',style:'display: flex'}),n.innerHTML='<span class="loader"></span>',BODY.insertAdjacentElement('beforeend',n),(()=>{const e=document.createElement('div');e.classList.add('infiniteScroll'),t=e,BODY.insertAdjacentElement('beforeend',e)})();METHODS.IO(l).observe(t)}}})();'complete'===document.readyState?prototype.init():document.addEventListener&&document.addEventListener('DOMContentLoaded',prototype.init);